schema_version: 1

name: "rhdm-7/rhdm70-decisioncentral-openshift"
description: "Red Hat Decision Manager Central 7.0 OpenShift container image"
version: "1.1"
from: "rhdm-7/rhdm70-decisioncentral:latest"
labels:
    - name: "com.redhat.component"
      value: "rhdm-7-rhdm70-decisioncentral-openshift-container"
    - name: "io.k8s.description"
      value: "Platform for running Red Hat Decision Manager Central"
    - name: "io.k8s.display-name"
      value: "Red Hat Decision Manager Central 7.0"
    - name: "io.openshift.expose-services"
      value: "8080:http"
    - name: "io.openshift.tags"
      value: "javaee,eap,eap7,rhdm,rhdm7"
envs:
    - name: "HTTPS_ENABLE_HTTP2"
      value: "true"
    - name: "KIE_ADMIN_USER"
      example: "adminUser"
      description: "KIE administrator username"
    - name: "KIE_ADMIN_PWD"
      example: "admin1!"
      description: "KIE administrator password"
    - name: "KIE_MAVEN_USER"
      example: "mavenUser"
      description: "KIE maven username"
    - name: "KIE_MAVEN_PWD"
      example: "maven1!"
      description: "KIE maven password"
    - name: "KIE_SERVER_CONTROLLER_PROTOCOL"
      example: "http"
      description: "KIE server controller protocol (Used to set the org.kie.server.controller system property)"
    - name: "KIE_SERVER_CONTROLLER_SERVICE"
      example: "buscentr-myapp"
      description: "KIE server controller service (Used to set the org.kie.server.controller system property if host and port aren't set)"
    - name: "KIE_SERVER_CONTROLLER_HOST"
      example: "my-app-controller.os.mycloud.com"
      description: "KIE server controller host (Used to set the org.kie.server.controller system property)"
    - name: "KIE_SERVER_CONTROLLER_PORT"
      example: "8080"
      description: "KIE server controller port (Used to set the org.kie.server.controller system property)"
    - name: "KIE_SERVER_CONTROLLER_TOKEN"
      example: "dasd373egds"
      description: "KIE server controller token for bearer authentication (Sets the org.kie.server.controller.token system property)"
    - name: "KIE_SERVER_CONTROLLER_USER"
      example: "controllerUser"
      description: "KIE server controller username for basic authentication (Sets the org.kie.server.controller.user system property)"
    - name: "KIE_SERVER_CONTROLLER_PWD"
      example: "controller1!"
      description: "KIE server controller password for basic authentication (Sets the org.kie.server.controller.pwd system property)"
    - name: "KIE_SERVER_TOKEN"
      example: "dasd373egds"
      description: "KIE server token for bearer authentication (Sets the org.kie.server.token system property)"
    - name: "KIE_SERVER_USER"
      example: "executionUser"
      description: "KIE execution server username for basic authentication (Sets the org.kie.server.user system property)"
    - name: "KIE_SERVER_PWD"
      example: "execution1!"
      description: "KIE execution server password for basic authentication (Sets the org.kie.server.pwd system property)"
    - name: "SCRIPT_DEBUG"
      example: "true"
      description: "If set to true, ensurses that the bash scripts are executed with the -x option, printing the commands and their arguments as they are executed."
    - name: "WORKBENCH_MAX_METASPACE_SIZE"
      example: "512"
      description: "The maximum metaspace for the Decision Central, it will set the GC_MAX_METASPACE_SIZE, its default value is 1024mb."
    - name: "CUSTOM_INSTALL_DIRECTORIES"
      example: "custom,shared"
      description: "A list of comma-separated directories used for installation and configuration of artifacts for the image during the S2I process."
    - name: "GIT_HOOKS_DIR"
      example: "/opt/git/hooks"
      description: "If provided, the specified path will be copied to all the git repositories hooks dir"
    - name: "AUTH_LDAP_ALLOW_EMPTY_PASSWORDS"
      description: "Whether to allow empty passwords. Most LDAP servers treat empty passwords as anonymous login attempts. To reject empty passwords, set this to false."
      example: "false"
    - name: "AUTH_LDAP_BASE_CTX_DN"
      description: "The fixed DN of the top-level context to begin the user search."
      example: "ou=users,ou=example,ou=com"
    - name: "AUTH_LDAP_BASE_FILTER"
      description: "A search filter used to locate the context of the user to authenticate. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. A common example for the search filter is (uid={0})."
      example: "(uid={0})"
    - name: "AUTH_LDAP_BIND_CREDENTIAL"
      description: "Used to store the credentials for the DN. "
      example: "Passw0rd"
    - name: "AUTH_LDAP_BIND_DN"
      description: "The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the baseCtxDN and rolesCtxDN values."
      example: "uid=admin,ou=users,ou=exmample,ou=com"
    - name: "AUTH_LDAP_DEFAULT_ROLE"
      description: "A role included for all authenticated users"
      example: "guest"
    - name: "AUTH_LDAP_DISTINGUISHED_NAME_ATTRIBUTE"
      description: "The name of the attribute in the user entry that contains the DN of the user. This may be necessary if the DN of the user itself contains special characters, backslash for example, that prevent correct user mapping. If the attribute does not exist, the entry’s DN is used."
      example: "distinguishedName"
    - name: "AUTH_LDAP_JAAS_SECURITY_DOMAIN"
      description: "he JMX ObjectName of the JaasSecurityDomain used to decrypt the password."
    - name: "AUTH_LDAP_PARSE_ROLE_NAME_FROM_DN"
      description: "A flag indicating if the DN returned by a query contains the roleNameAttributeID. If set to true, the DN is checked for the roleNameAttributeID. If set to false, the DN is not checked for the roleNameAttributeID. This flag can improve the performance of LDAP queries."
      example: "false"
    - name: "AUTH_LDAP_PARSE_USERNAME"
      description: "A flag indicating if the DN is to be parsed for the username. If set to true, the DN is parsed for the username. If set to false the DN is not parsed for the username. This option is used together with usernameBeginString and usernameEndString."
      example: "true"
    - name: "AUTH_LDAP_REFERRAL_USER_ATTRIBUTE_ID_TO_CHECK"
      description: "If you are not using referrals, this option can be ignored. When using referrals, this option denotes the attribute name which contains users defined for a certain role, for example member, if the role object is inside the referral. Users are checked against the content of this attribute name. If this option is not set, the check will always fail, so role objects cannot be stored in a referral tree."
    - name: "AUTH_LDAP_ROLE_ATTRIBUTE_ID"
      description: "Name of the attribute containing the user roles."
      example: "memberOf"
    - name: "AUTH_LDAP_ROLE_ATTRIBUTE_IS_DN"
      description: "Whether or not the roleAttributeID contains the fully-qualified DN of a role object. If false, the role name is taken from the value of the roleNameAttributeId attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to true."
      example: "true"
    - name: "AUTH_LDAP_ROLE_FILTER"
      description: "A search filter used to locate the roles associated with the authenticated user. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. The authenticated userDN is substituted into the filter anywhere a {1} is used. An example search filter that matches on the input username is (member={0}). An alternative that matches on the authenticated userDN is (member={1})."
      example: "(memberOf={1})"
    - name: "AUTH_LDAP_ROLE_NAME_ATTRIBUTE_ID"
      description: "Name of the attribute within the roleCtxDN context which contains the role name. If the roleAttributeIsDN property is set to true, this property is used to find the role object’s name attribute."
      example: "name"
    - name: "AUTH_LDAP_ROLE_RECURSION"
      description: "The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to 0."
      example: "1"
    - name: "AUTH_LDAP_ROLES_CTX_DN"
      description: "The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is."
      example: "ou=groups,ou=example,ou=com"
    - name: "AUTH_LDAP_SEARCH_SCOPE"
      description: "The search scope to use."
      example: "SUBTREE_SCOPE"
    - name: "AUTH_LDAP_SEARCH_TIME_LIMIT"
      description: "The timeout in milliseconds for user or role searches."
      example: "10000"
    - name: "AUTH_LDAP_URL"
      description: "LDAP Endpoint to connect to"
      example: "ldap://myldap.example.com"
    - name: "AUTH_LDAP_USERNAME_BEGIN_STRING"
      description: "Defines the String which is to be removed from the start of the DN to reveal the username. This option is used together with usernameEndString and only taken into account if parseUsername is set to true."
    - name: "AUTH_LDAP_USERNAME_END_STRING"
      description: "Defines the String which is to be removed from the end of the DN to reveal the username. This option is used together with usernameBeginString and only taken into account if parseUsername is set to true."
    - name: "AUTH_LDAP_BASE_CTX_DN"
      description: "The fixed DN of the top-level context to begin the user search."
      example: "ou=users,ou=example,ou=com"
    - name: "AUTH_LDAP_BASE_FILTER"
      description: "A search filter used to locate the context of the user to authenticate. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. A common example for the search filter is (uid={0})."
      example: "(uid={0})"
    - name: "AUTH_LDAP_BIND_CREDENTIAL"
      description: "Used to store the credentials for the DN. "
      example: "Passw0rd"
    - name: "AUTH_LDAP_BIND_DN"
      description: "The DN used to bind against the LDAP server for the user and roles queries. This DN needs read and search permissions on the baseCtxDN and rolesCtxDN values."
      example: "uid=admin,ou=users,ou=exmample,ou=com"
    - name: "AUTH_LDAP_DEFAULT_ROLE"
      description: "A role included for all authenticated users"
      example: "guest"
    - name: "AUTH_LDAP_DISTINGUISHED_NAME_ATTRIBUTE"
      description: "The name of the attribute in the user entry that contains the DN of the user. This may be necessary if the DN of the user itself contains special characters, backslash for example, that prevent correct user mapping. If the attribute does not exist, the entry’s DN is used."
      example: "distinguishedName"
    - name: "AUTH_LDAP_JAAS_SECURITY_DOMAIN"
      description: "he JMX ObjectName of the JaasSecurityDomain used to decrypt the password."
    - name: "AUTH_LDAP_PARSE_ROLE_NAME_FROM_DN"
      description: "A flag indicating if the DN returned by a query contains the roleNameAttributeID. If set to true, the DN is checked for the roleNameAttributeID. If set to false, the DN is not checked for the roleNameAttributeID. This flag can improve the performance of LDAP queries."
      example: "false"
    - name: "AUTH_LDAP_PARSE_USERNAME"
      description: "A flag indicating if the DN is to be parsed for the username. If set to true, the DN is parsed for the username. If set to false the DN is not parsed for the username. This option is used together with usernameBeginString and usernameEndString."
      example: "true"
    - name: "AUTH_LDAP_REFERRAL_USER_ATTRIBUTE_ID_TO_CHECK"
      description: "If you are not using referrals, this option can be ignored. When using referrals, this option denotes the attribute name which contains users defined for a certain role, for example member, if the role object is inside the referral. Users are checked against the content of this attribute name. If this option is not set, the check will always fail, so role objects cannot be stored in a referral tree."
    - name: "AUTH_LDAP_ROLE_ATTRIBUTE_ID"
      description: "Name of the attribute containing the user roles."
      example: "memberOf"
    - name: "AUTH_LDAP_ROLE_ATTRIBUTE_IS_DN"
      description: "Whether or not the roleAttributeID contains the fully-qualified DN of a role object. If false, the role name is taken from the value of the roleNameAttributeId attribute of the context name. Certain directory schemas, such as Microsoft Active Directory, require this attribute to be set to true."
      example: "true"
    - name: "AUTH_LDAP_ROLE_FILTER"
      description: "A search filter used to locate the roles associated with the authenticated user. The input username or userDN obtained from the login module callback is substituted into the filter anywhere a {0} expression is used. The authenticated userDN is substituted into the filter anywhere a {1} is used. An example search filter that matches on the input username is (member={0}). An alternative that matches on the authenticated userDN is (member={1})."
      example: "(memberOf={1})"
    - name: "AUTH_LDAP_ROLE_NAME_ATTRIBUTE_ID"
      description: "Name of the attribute within the roleCtxDN context which contains the role name. If the roleAttributeIsDN property is set to true, this property is used to find the role object’s name attribute."
      example: "name"
    - name: "AUTH_LDAP_ROLE_RECURSION"
      description: "The numbers of levels of recursion the role search will go below a matching context. Disable recursion by setting this to 0."
      example: "1"
    - name: "AUTH_LDAP_ROLES_CTX_DN"
      description: "The fixed DN of the context to search for user roles. This is not the DN where the actual roles are, but the DN where the objects containing the user roles are. For example, in a Microsoft Active Directory server, this is the DN where the user account is."
      example: "ou=groups,ou=example,ou=com"
    - name: "AUTH_LDAP_SEARCH_SCOPE"
      description: "The search scope to use."
      example: "SUBTREE_SCOPE"
    - name: "AUTH_LDAP_SEARCH_TIME_LIMIT"
      description: "The timeout in milliseconds for user or role searches."
      example: "10000"
    - name: "AUTH_LDAP_URL"
      description: "LDAP Endpoint to connect to"
      example: "ldap://myldap.example.com"
    - name: "AUTH_LDAP_USERNAME_BEGIN_STRING"
      description: "Defines the String which is to be removed from the start of the DN to reveal the username. This option is used together with usernameEndString and only taken into account if parseUsername is set to true."
    - name: "AUTH_LDAP_USERNAME_END_STRING"
      description: "Defines the String which is to be removed from the end of the DN to reveal the username. This option is used together with usernameBeginString and only taken into account if parseUsername is set to true."
ports:
    - value: 8443
    - value: 8778
modules:
      repositories:
          - git:
              url: https://github.com/jboss-openshift/cct_module.git
              ref: sprint-18
          - git:
              url: https://github.com/jboss-container-images/jboss-kie-modules.git
              ref: master
      install:
          - name: dynamic-resources
          - name: java-alternatives
          - name: os-java-jolokia
          - name: jolokia
          - name: os-eap7-openshift
          - name: os-eap71-openshift
          - name: os-eap7-modules
          - name: os-eap71-modules
          - name: os-eap7-ping
          - name: os-eap-activemq-rar
          - name: os-java-run
          - name: os-eap-launch
          - name: os-eap7-launch
          - name: os-eap-logging
          - name: os-eap-probes
          - name: jboss-maven
          - name: os-eap-db-drivers
          - name: os-eap-sso
          - name: os-eap70-sso
          - name: os-java-hawkular
          - name: os-eap70-hawkular
          - name: os-eap-hawkular
          - name: os-eap-deployment-scanner
          - name: os-eap-extensions
          - name: openshift-layer
          - name: openshift-passwd
          - name: os-logging
          - name: os.bpmsuite.common
          - name: os.bpmsuite.businesscentral
packages:
      repositories:
          - jboss-os
      install:
          - git
run:
      user: 185
      cmd:
          - "/opt/eap/bin/openshift-launch.sh"
osbs:
      repository:
          name: containers/rhdm-7-decisioncentral-openshift
          branch: jb-rhdm-7.0-decisioncentral-openshift-rhel-7
